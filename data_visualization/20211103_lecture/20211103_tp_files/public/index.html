<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>

    <!-- import the d3 library -->
    <!-- <script type="text/javascript" src="https://d3js.org/d3.v5.min.js"></script> -->
    <script type='text/javascript' src='lib/d3.v5.min.js'></script>

    <!-- style sheet -->
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <svg id="scene">
        <g id='links'></g>
        <g id='labels'></g>
        <g id='nodes'></g>
    </svg>

    <script>
        let width = 1250,
            // height = 700,
            height = 1050,
            svg = d3.select('#scene').attr("width", width).attr("height", height);


        d3.json("data.json").then(data => {
            draw(data.persons)
        })

        function draw(persons) {
            var xScale = d3.scaleLinear()
                .domain(d3.extent(persons, d => d.position.x))
                .range([100, width-100])
            var yScale = d3.scaleLinear()
                .domain(d3.extent(persons, d => d.position.y))
                .range([100, height-100])

            svg.selectAll('circle')
                .data(persons)
                .enter()
                .append('circle') // create a circle in the svg
                .attr("stroke-width", 2) // with attributes ...
                .attr("cx", d => xScale(d.position.x))
                .attr("cy", d => yScale(d.position.y))
                .attr('stroke', 'black')
                .attr("r", d => 15)
                .attr('fill', 'green')

            let labelGroup = svg.selectAll('g.person')
                .data(persons)
                .enter()
                .append('g')
                .attr('class', 'person')
                .attr('transform', d => `translate(${d.position.x * 8 + 7}, ${d.position.y * 8})`)

            labelGroup.append('rect')
                .attr('width', d => d.name.length * 10 + 5)
                .attr('stroke-width', 2)
                .attr('stroke', 'black')
                .attr('height', 17)
                .attr('fill', 'white')

            labelGroup.append('text')
                .text(d => d.name)
                .attr('y', 13)
                .attr('x', d => d.name.length * 10 + 2)
                .attr('fill', 'black')
                .attr('text-anchor', 'end')
                .attr("font-size", ".8em")
        }
    </script>

</body>

</html>